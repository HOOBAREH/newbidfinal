var m_strUpperCase = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; var m_strLowerCase = "abcdefghijklmnopqrstuvwxyz"; var m_strNumber = "0123456789"; var m_strCharacters = "!@#$%^&*?_~"; var ccErrorNo = 0; var usernameTimer = null; function checkUsername() { if (usernameTimer) { clearTimeout(usernameTimer) } usernameTimer = setTimeout("checkUsernameTimer()", 500) } function checkUsernameTimer() { if (usernameTimer) { clearTimeout(usernameTimer) } usernameTimer = null; var a = /^[0-9A-Za-z]+$/; if ($("#account_username").val().length < 5 || !a.test($("#account_username").val()) || $("#account_username").val().length > 16) { outline("flag_username", "account_username"); return } var b = "/ajax/register_check.php?action=checkusername&username=" + $("#account_username").val(); $.ajax({ url: b, cache: true, dataType: "json", success: function (c) { if (c.available && c.available == "Yes") { outline_ok("flag_username", "account_username"); if ($("#username_response")) { $("#username_response").html("") } } else { if (c.available && c.available == "No") { outline("flag_username", "account_username"); if ($("#username_response")) { $("#username_response").html('<font color=red style="padding-bottom:8px;font-size:12px"><strong class="whatcolor">' + c.message + "</strong></font><br/>") } } } } }) } function popupTerms() { try { var c = 0; if ($("#account_country") && $("#account_country").val() != "") { c = $("#account_country").val() } var b = window.open("/help/terms.php?t=popup&noagree=1&m=" + c, "name", "height=450,width=500,scrollbars=1"); return false } catch (a) { logRegError("Popup Terms: " + a) } } function popupPrivacy() { try { var c = 0; if ($("#account_country") && $("#account_country").val() != "") { c = $("#account_country").val() } var b = window.open("/company/privacy.php?t=popup&m=" + c, "name", "height=450,width=500,scrollbars=1"); return false } catch (a) { logRegError("Popup Privacy: " + a) } } function popupImportantInfo() { try { var c = 0; if ($("#account_country") && $("#account_country").val() != "") { c = $("#account_country").val() } var b = window.open("/company/important-info.php?m=" + c, "name", "height=450,width=500,scrollbars=1"); return false } catch (a) { logRegError("Popup Important Info: " + a) } } function checkPassword(e) { var d = 0; if (e.length < 5) { d += 5 } else { if (e.length > 4 && e.length < 8) { d += 15 } else { if (e.length > 7) { d += 25 } } } var f = countContain(e, m_strUpperCase); var g = countContain(e, m_strLowerCase); var a = f + g; if (f == 0 && g != 0) { d += 10 } else { if (f != 0 && g != 0) { d += 25 } } var b = countContain(e, m_strNumber); if (b == 1) { d += 15 } if (b >= 3) { d += 20 } var c = countContain(e, m_strCharacters); if (c == 1) { d += 10 } if (c > 1) { d += 25 } if (b != 0 && a != 0) { d += 5 } if (b != 0 && a != 0 && c != 0) { d += 8 } if (b != 0 && f != 0 && g != 0 && c != 0) { d += 10 } return d } function runPassword(g, c) { var f = checkPassword(g); var b = document.getElementById(c + "_bar"); var e = document.getElementById(c + "_text"); if (!b || !e) { return } b.style.width = f + "%"; if (f >= 90) { var a = _t.display("very_secure", "Very Secure"); var d = "#0ca908" } else { if (f >= 80) { var a = _t.display("secure", "Secure"); vstrColor = "#7ff67c" } else { if (f >= 70) { var a = _t.display("very_strong", "Very Strong"); var d = "#1740ef" } else { if (f >= 60) { var a = _t.display("strong", "Strong"); var d = "#5a74e3" } else { if (f >= 50) { var a = _t.display("average", "Average"); var d = "#e3cb00" } else { if (f >= 25) { var a = _t.display("weak", "Weak"); var d = "#e7d61a" } else { var a = _t.display("very_weak", "Very Weak"); var d = "#e71a1a" } } } } } } b.style.backgroundColor = d; e.innerHTML = "<span >" + a + " - " + f + "</span>" } function countContain(c, b) { var a = 0; for (i = 0; i < c.length; i++) { if (b.indexOf(c.charAt(i)) > -1) { a++ } } return a } function checkForm() {
    outline_reset("flag_firstname", "account_firstname"); outline_reset("flag_lastname", "account_lastname"); outline_reset("flag_bday", "bday_month"); outline_reset("flag_bday", "bday_day"); outline_reset("flag_bday", "bday_year"); outline_reset("flag_gender", "account_gender"); outline_reset("flag_email", "account_email"); outline_reset("flag_password", "account_password"); outline_reset("flag_password2", "account_password2"); outline_reset("flag_username", "account_username"); outline_reset("flag_verify", "captcha_verify"); outline_reset(null, "agree"); var a = []; if ($("#account_firstname").val() == "") { a.push(_t.display("error_enter_firstname", "Please enter your first name.")); outline("flag_firstname", "account_firstname") } if ($("#account_lastname").val() == "") { a.push(_t.display("error_enter_lastname", "Please enter your last name.")); outline("flag_lastname", "account_lastname") } if ($("#bday_month").val() == "" || $("#bday_day").val() == "" || $("#bday_year").val() == "") { a.push(_t.display("error_enter_birthday", "Please specify your full birthday.")); if ($("#bday_month").val() == "") { outline("flag_bday", "bday_month") } if ($("#bday_day").val() == "") { outline("flag_bday", "bday_day") } if ($("#bday_year").val() == "") { outline("flag_bday", "bday_year") } } years = calculate_age($("#bday_month").val(), $("#bday_day").val(), $("#bday_year").val()); if (years < 18) { a.push(_t.display("error_underage", "You are not 18 years old. Please come back when you are 18!")) } if ($("#account_gender").val() == "") { a.push(_t.display("error_enter_gender", "Please specify your gender.")); outline("flag_gender", "account_gender") } var d = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/; if (!d.test($("#account_email").val())) {
        a.push(_t.display("error_email_invalid", "Please check the validity of your email address."));
        outline("flag_email", "account_email")
    } else { if (!$("#account_email2").is(":hidden") && $("#account_email").val() != $("#account_email2").val()) { a.push(_t.display("error_email_nomatch", "Your confirmed email address is different.")); outline("flag_email", "account_email") } } if ($("#account_password").val() == "") { a.push(_t.display("error_enter_password", "Please enter a password for your account.")); outline("flag_password", "account_password") } else { if (checkPassword($("#account_password").val()) < 25) { a.push(_t.display("error_password_insecure", "Please specify a more secure password.")); outline("flag_password", "account_password") } else { if (!$("#account_password2").is(":hidden") && $("#account_password").val() != $("#account_password2").val()) { a.push(_t.display("error_password_nomatch", "Your confirmed password does not match.")); outline("flag_password2", "account_password2") } } } var e = /^[0-9A-Za-z]+$/; if ($("#account_username").val().length < 5) { a.push(_t.display("error_username_tooshort", "Please specify a username at least 5 characters long.")); outline("flag_username", "account_username") } else { if (!e.test($("#account_username").val())) { a.push(_t.display("error_username_badchars", "Usernames can only have alphanumeric characters.")); outline("flag_username", "account_username") } else { if ($("#account_username").val().length > 16) { a.push(_t.display("error_username_toolong", "Please shorten your username to under 17 characters.")); outline("flag_username", "account_username") } } } if ($("#agree:checked").length > 0 && $("#agree:checked").val() != "On") { a.push(_t.display("error_agree_to_tos", "You must agree with the terms of the site.")); outline(null, "agree") } if (a.length == 0) { return true } var b = '<div align=left style="margin-left:15px"><strong>' + _t.display("following_errors_occurred", "The following errors occured:") + '</strong><ul style="margin-left:10px">'; for (var c = 0; c < a.length; c++) { b += "<li>" + a[c] + "</li>" } b += "</ul></div>"; console.log(b); errorMsg2(b, "Registration Errors"); return false
} function checkFormStep1() { outline_reset("flag_email", "account_email"); outline_reset("flag_zipcode", "zipcode"); outline_reset(null, "agree"); var a = []; var b = /^\d{5}$/; if (!b.test($("#zipcode").val())) { a.push(_t.display("error_zipcode", "Please check the validity of your zipcode")); outline("flag_zipcode", "zipcode") } if ($("#agree:checked").val() != "On") { a.push(_t.display("error_agree_to_tos", "You must agree with the terms of the site.")); outline(null, "agree") } $.post("/ajax/register_check.php", { action: "checkemail", account_email: $("#account_email").val() }, function (e) { if (e.available == "No") { a.push(e.message); outline("flag_email", "account_email") } if (a.length == 0) { $.post("/landing/_mod/registration.php", { action: "newshort", account_email: $("#account_email").val() }, function (f) { $.post("/ajax/zipcode.php", { action: "checkzipcode", zipcode: $("#zipcode").val() }, function (g) { if (g.available == "Yes") { $("#billing_city").val(g.city); $("#addressRegion").val(g.region) } }, "json"); $("#step1Block").hide(); $("#step2Block").show(); $.scrollTo(640, 800); $("#fbpix").attr("src", "/marketing/pixels/firstbuy.php"); window.frames.fbpix.location.reload(); $("#billing_zip").val($("#zipcode").val()) }) } else { var c = '<div align=left style="margin-left:15px"><strong>' + _t.display("following_errors_occurred", "The following errors occured:") + '</strong><ul style="margin-left:10px">'; for (var d = 0; d < a.length; d++) { c += "<li>" + a[d] + "</li>" } c += "</ul></div>"; errorMsg2(c, "Registration Errors"); $("img#processingImg").hide(); $("#step1Submit").show() } }, "json") } function checkFormCompleteProfile() {
    outline_reset("flag_bday", "bday_month"); outline_reset("flag_bday", "bday_day"); outline_reset("flag_bday", "bday_year"); outline_reset("flag_gender", "account_gender"); outline_reset("flag_password", "account_password"); outline_reset("flag_password2", "account_password2"); outline_reset("flag_username", "account_username"); var a = []; if ($("#account_password").length != 0) { if ($("#account_password").val() == "") { a.push(_t.display("error_enter_password", "Please enter a password for your account.")); outline("flag_password", "account_password") } else { if (checkPassword($("#account_password").val()) < 25) { a.push(_t.display("error_password_insecure", "Please specify a more secure password. Your password should be at least 6 characters long, and include a capital letter(s) and/or number(s).")); outline("flag_password", "account_password") } else { if ($("#account_password").val() != $("#account_password2").val()) { a.push(_t.display("error_password_nomatch", "Your confirmed password does not match.")); outline("flag_password2", "account_password2") } } } } if ($("#account_username").length != 0) {
        var d = /^[0-9A-Za-z]+$/; if ($("#account_username").val().length < 5) { a.push(_t.display("error_username_tooshort", "Please specify a username at least 5 characters long.")); outline("flag_username", "account_username") } else {
            if (!d.test($("#account_username").val())) { a.push(_t.display("error_username_badchars", "Usernames can only have alphanumeric characters.")); outline("flag_username", "account_username") } else {
                if ($("#account_username").val().length > 16) {
                    a.push(_t.display("error_username_toolong", "Please shorten your username to under 17 characters."));
                    outline("flag_username", "account_username")
                }
            }
        }
    } if (a.length == 0) { return true } var b = '<div align=left style="margin-left:15px"><strong>' + _t.display("following_errors_occurred", "The following errors occured:") + '</strong><ul style="margin-left:10px">'; for (var c = 0; c < a.length; c++) { b += "<li>" + a[c] + "</li>" } b += "</ul></div>"; errorMsg2(b, "Registration Errors"); return false
} function calculate_age(b, a, c) { today_date = new Date(); today_year = today_date.getYear(); today_month = today_date.getMonth(); today_day = today_date.getDate(); age = (today_year + 1900) - c; if (today_month < (b - 1)) { age-- } if (((b - 1) == today_month) && (today_day < a)) { age-- } if (age > 1900) { age -= 1900 } return age } function checkPasswords() { var a = []; if ($("#account_password").val() == "") { a.push(_t.display("error_enter_password", "Please enter a password for your account.")); outline(null, "account_password") } else { if (checkPassword($("#account_password").val()) < 25) { a.push(_t.display("error_password_insecure", "Please specify a more secure password.")); outline(null, "account_password") } else { if ($("#account_password").val() != $("#account_password2").val()) { a.push(_t.display("error_password_nomatch", "Your confirmed password does not match.")); outline(null, "account_password2") } } } if (a.length == 0) { return true } var b = '<div align=left style="margin-left:15px"><strong>' + _t.display("following_errors_occurred", "The following errors occured:") + '</strong><ul style="margin-left:10px">'; for (var c = 0; c < a.length; c++) { b += "<li>" + a[c] + "</li>" } b += "</ul></div>"; errorMsg2(b, "Password Error"); return false } function checkChangePassword() { var a = []; if ($("#account_oldpassword").val().length < 6) { a.push(_t.display("error_enter_old_password", "Please enter your old password (your current password)")); outline(null, "account_oldpassword") } else { if ($("#account_password").val() == "") { a.push(_t.display("error_enter_new_password", "Please enter a new password for your account.")); outline(null, "account_password") } else { if (checkPassword($("#account_password").val()) < 25) { a.push(_t.display("error_password_insecure", "Please specify a more secure password.")); outline(null, "account_password") } else { if ($("#account_password").val() != $("#account_password2").val()) { a.push(_t.display("error_password_nomatch", "Your confirmed password does not match.")); outline(null, "account_password2") } else { if ($("#account_password").val() == $("#account_oldpassword").val()) { a.push(_t.display("error_newpass_match_oldpass", "Your old password matches your new password!")); outline(null, "account_password") } } } } } if (a.length == 0) { return true } var b = '<div align=left style="margin-left:15px"><strong>' + _t.display("following_errors_occurred", "The following errors occured:") + '</strong><ul style="margin-left:10px">'; for (var c = 0; c < a.length; c++) { b += "<li>" + a[c] + "</li>" } b += "</ul></div>"; errorMsg2(b, _t.display("error_changepassword_title", "Change Password Error")); return false } function outline(b, a) { if (a != null && $("#" + a)) { $("#" + a).css("outline", "1px solid red") } if (b != null && $("#" + b)) { $("#" + b).attr("src", "https://static.quibids.com/site/images/icons/info-icon.png"); $("#" + b).css("display", "block") } } function outline_ok(b, a) { if (a != null && $("#" + a)) { $("#" + a).css("outline", "") } if (b != null && $("#" + b)) { $("#" + b).attr("src", "https://static.quibids.com/site/images/icons/success.png"); $("#" + b).css("display", "block") } } function outline_reset(b, a) { if (a != null && $("#" + a)) { $("#" + a).css("outline", "") } if (b != null && $("#" + b)) { $("#" + b).css("display", "none") } } function errorMsg2(b, a) { var c = "<br><div style='float:right'><input type='button' value='Ok!' onclick='$(\"#popupModal\").dialog( \"close\" );'></div>"; $("#popupModal").html("<strong>" + b + "</strong>" + c); $(function () { $("#popupModal").dialog({ modal: true, title: a, width: 500 }) }) } function logRegError(b) { var a = "/landing/track.php?mid=" + mid + "&msg=" + escape(b); $.ajax({ url: a, cache: false, success: function (c) { } }) };