$(function(){$("#reviews-selector").live("mouseleave",function(){$("#droplinks").hide("fade","normal")});$("#reviews-menu-btn").live("click",function(){$("#droplinks").show()})});if(typeof ReviewsObj=="undefined"){function ReviewsObj(){var n=this;var l=500;var m=128;var c=10000;var i="/ajax/reviews.php";var k="quick_look";var h=false;var j=1;var b;var e;var g;var a;var d;var f;this.toggleReviewCommentAdd=function(){if(!this.disabled&&!isNaN(this.reviewId)){$("#comment-thanks-"+this.reviewId).remove();$("#review-comments-"+this.reviewId).hide();$("#commentErrors").html("");if($("#add-comment-"+this.reviewId).css("display")=="none"){$("#add-comment-"+this.reviewId).fadeIn("fast").find("textarea#review-comment-"+this.reviewId).val("").keyup();$("#comment_post").attr("class","buttons small blue");$("#comment_cancel").attr("class","buttons small blue")}else{$("#add-comment-"+this.reviewId).hide()}}return this};this.toggleReviewHelpful=function(){var o=this.reviewId;$("#review-helpful-"+o).toggle();var p=function(){$("#review-helpful-"+o).toggle()};if($("#review-helpful-"+o).is(":visible")){setTimeout(p,5000)}return this};this.markReviewHelpful=function(o){if(typeof o=="undefined"){o=1}var p={a:(o==1?"review_helpful":"review_not_helpful"),reviewId:this.reviewId};$.ajax({url:i,data:p,dataType:"json",type:"post",beforeSend:function(){n.disabled=true},complete:function(u,t){var q=n.parseResponse(u);$("#review-helpful-"+n.reviewId+" a").hide();$("#helpful-thanks-"+n.reviewId).html(q.html).css("display","block").show().fadeOut(2000,function(){$(this).hide();$("#review-helpful-"+n.reviewId).hide();$("#review-helpful-"+n.reviewId+" a").show()})}});return this};this.postReviewComment=function(){if(!this.disabled&&!isNaN(this.reviewId)){var o=$("textarea#review-comment-"+this.reviewId);var p={a:"post_comment",reviewId:this.reviewId,comment:o.val()};var q=n.reviews_content.find("#review-submit-actions-"+a);$.ajax({url:i,data:p,dataType:"json",type:"post",beforeSend:function(){n.disabled=true;o.attr("disabled","disabled").addClass("inactive");q.addClass("wait")},complete:function(v,u){var t=n.parseResponse(v);o.removeAttr("disabled").removeClass("inactive");q.removeClass("wait");if(t.success!=true){$("#commentErrors").html(t.html);return}var w=$('<div class="review-submit-thanks" id="comment-thanks-'+n.reviewId+'">'+t.html+"</div>");$("#add-comment-"+n.reviewId).hide().after(w);w.fadeIn()}})}return this};this.setupReviewCommentTextareaCounters=function(){this.reviews_content.find("textarea[name=product_review_comment_text]").off("keyup.counter").on("keyup.counter",function(){if($(this).val().length>n.max_comment_length){$(this).val($(this).val().substr(0,n.max_comment_length))}n.reviews_content.find("#remaining-chars-"+$(this).attr("rel")).html(parseInt(l-$(this).val().length).toString())});return this};this.postReview=function(){if(!this.disabled&&!isNaN(this.reviewId)){var o=this.reviews_content.find("textarea#product-review-text");var t=this.reviews_content.find("input#product-review-title");var r=this.reviews_content.find("input#product-review-upc");var p=this.upc;if(r.val()){p=r.val()}var q={a:"post_review",upc:p,review:o.val(),title:t.val(),rating:this.reviewRating};var s=this.reviews_content.find("#review-submit-actions");$.ajax({url:i,data:q,dataType:"json",type:"post",beforeSend:function(){n.disabled=true;o.attr("disabled","disabled").addClass("inactive");t.attr("disabled","disabled").addClass("inactive");s.addClass("wait")},complete:function(w,v){var u=n.parseResponse(w);o.removeAttr("disabled").removeClass("inactive");t.removeAttr("disabled").removeClass("inactive");s.removeClass("wait");if(u.success!=true){$("#reviewErrors").html(u.html);return}var x=$('<div class="review-submit-thanks" id="review-thanks">'+u.html+"</div>");$("#add-review").hide().after(x);x.fadeIn()}})}return this};this.showMore=function(q,r){if(!this.disabled){if(q){r=$(r);var p=n.reviews_content.find("#review-text-"+q);var o=n.reviews_content.find("#preview-text-"+q);if(r.hasClass("toggle-text")){if(r.html()=="Hide Full Review"){r.html("Show Full Review");p.hide();o.fadeIn("fast")}else{r.html("Hide Full Review");o.hide();p.fadeIn("fast")}return this}var s={a:"see_more",reviewId:q};this.request=$.ajax({url:i,data:s,dataType:"json",type:"post",complete:function(v,u){r.addClass("toggle-text").html("Hide Full Review");var t=n.parseResponse(v);o.hide();p.hide().html(t.html).fadeIn("fast")}})}}return this};this.loadNew=function(q){var o=this;if(!this.disabled){this.setCatalogId(q);var p={a:"everything",catalogId:q,page:1};$("#reviews").html("");if(typeof this.request!="undefined"){this.request.abort()}this.request=$.ajax({url:i,data:p,dataType:"json",type:"post",complete:function(v,u){var t=n.parseResponse(v);$("#reviews").css("display","none").html(t.html).fadeIn("fast",function(){n.init();if(t.reviewsEnabled){o.enableReviews()}else{o.disableReviews()}});$(".reviews-content").html(t.innerHTML);n.setReviewsContentDiv($(".reviews-content"));n.setPage(1).navigate().doNothing()
}})}return this};this.enableReviews=function(){$("#auctionspecs_reviews").show()};this.disableReviews=function(){$("#auctionspecs_reviews").hide();$("#auctionspecs_description a").click()};this.navigate=function(){var o=this;if(!this.disabled){var p={a:this.section,upc:this.upc,catalogId:this.catalogId,page:this.page};this.reviews_content.html("");$(".reviews-links>li>a").removeClass("active").filter(".reviews-link-"+this.section).addClass("active");if(typeof this.request!="undefined"&&this.request.readyState>1){this.request.abort()}this.request=$.ajax({url:i,data:p,dataType:"json",type:"post",complete:function(u,t){var q=n.parseResponse(u);if(q&&q.html){n.reviews_content.css("display","none").html(q.html).fadeIn("fast",function(){n.init();if(q.reviewsEnabled){o.enableReviews()}else{o.disableReviews()}})}$("body").trigger("reviewNavigationComplete")}})}return this};this.parseResponse=function(s){this.disabled=false;try{var o=$.parseJSON(s.responseText);if(typeof o.redirect!="undefined"){window.location.href=o.redirect}if(typeof o.alerts!="undefined"){for(var p in o.alerts){alert(o.alerts[p])}}return o}catch(q){}};this.navigateComments=function(o){if(typeof(o)=="undefined"){o=false}if(!this.disabled){if(o||($("#review-comments-"+this.reviewId).css("display")=="none")){var p={a:"comments",reviewId:this.reviewId,page:this.cpage};if(typeof this.request!="undefined"){this.request.abort()}this.request=$.ajax({url:i,data:p,dataType:"json",type:"post",beforeSend:function(){n.disabled=true},complete:function(u,t){$("#comment-thanks-"+n.reviewId).remove();$("#add-comment-"+n.reviewId).hide();var q=n.parseResponse(u);comments=$("#review-comments-"+n.reviewId).html(q.html).fadeIn("fast")}})}else{$("#review-comments-"+this.reviewId).hide()}}return this};this.setPage=function(o){this.page=(typeof(o)=="undefined")?1:parseInt(o);return this};this.setSection=function(o){this.section=(typeof(o)=="undefined")?"quick_look":o;return this};this.setCommentPage=function(o){this.cpage=(typeof(o)=="undefined")?1:parseInt(o);return this};this.setReview=function(o){this.reviewId=(typeof(o)=="undefined")?"":parseInt(o);return this};this.setUPC=function(o){this.upc=(typeof o=="undefined")?"":o;return this};this.setCatalogId=function(o){this.catalogId=(typeof o=="undefined")?"":parseInt(o);return this};this.setReviewsContentDiv=function(o){if(typeof o=="string"){this.reviews_content=$(o)}else{if(typeof o=="object"){this.reviews_content=o}}return this};this.setReviewRating=function(p,o){this.reviewRating=(typeof p=="undefined")?5:parseInt(p);if(typeof o!="undefined"){n.reviews_content.find(".review-rating-star").removeClass("active");$(o).parents(".review-rating-star").addClass("active")}return this};this.setupReviewSubmitCounters=function(){var p=this.reviews_content.find(".review-rating-text");this.reviews_content.find(".review-rating-star>a").off("hover.ratings").on("hover.ratings",function(){p.html($(this).attr("rel"))});this.reviews_content.find(".review-rating-wrapper").off("mouseout").on("mouseout",function(){p.html(n.reviewRating)});var q=this.reviews_content.find("#product-review-title");q.off("keyup.counter").on("keyup.counter",function(){var r=q.val().length;if(r>m){q.val(q.val().substr(0,m))}n.reviews_content.find("#review-title-char-count").html(parseInt(m-r).toString())});var o=this.reviews_content.find("#product-review-text");o.off("keyup.counter").on("keyup.counter",function(){var r=o.val().length;if(r>c){o.val(o.val().substr(0,c))}n.reviews_content.find("#review-text-char-count").html(parseInt(c-r).toString())});return this};this.init=function(){this.setupReviewCommentTextareaCounters();this.setupReviewSubmitCounters();return this};this.doNothing=function(){}}};